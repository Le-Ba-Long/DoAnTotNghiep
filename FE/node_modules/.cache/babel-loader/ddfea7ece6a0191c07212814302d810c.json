{"ast":null,"code":"var _jsxFileName = \"F:\\\\Do An Tot Nghiep\\\\FE\\\\src\\\\app\\\\auth\\\\AuthGuard.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport useAuth from 'app/hooks/useAuth';\nimport { flat } from 'app/utils/utils';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport AllPages from '../routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar userHasPermission = function userHasPermission(pathname, user, routes) {\n  var _matched$auth;\n\n  if (!user) {\n    return false;\n  }\n\n  var matched = routes.find(function (r) {\n    return r.path === pathname;\n  });\n  var authenticated = matched && matched.auth && matched.auth.length ? matched.auth.includes(user.role) : true;\n\n  if (!(matched !== null && matched !== void 0 && (_matched$auth = matched.auth) !== null && _matched$auth !== void 0 && _matched$auth.includes(user.role))) {\n    alert('Bạn ko có quyền truy cập!');\n  }\n\n  return authenticated;\n};\n\nvar AuthGuard = function AuthGuard(_ref) {\n  _s();\n\n  var children = _ref.children;\n\n  var _useAuth = useAuth(),\n      isAuthenticated = _useAuth.isAuthenticated,\n      user = _useAuth.user;\n\n  var _useLocation = useLocation(),\n      pathname = _useLocation.pathname;\n\n  var routes = flat(AllPages);\n  var hasPermission = userHasPermission(pathname, user, routes);\n  var authenticated = isAuthenticated && hasPermission; // // IF YOU NEED ROLE BASED AUTHENTICATION,\n  // // UNCOMMENT ABOVE LINES\n  // // AND COMMENT OUT BELOW authenticated VARIABLE\n  // let authenticated = isAuthenticated;\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: authenticated ? children : /*#__PURE__*/_jsxDEV(Navigate, {\n      replace: true,\n      to: \"/session/signin\",\n      state: {\n        from: pathname\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 9\n    }, _this)\n  }, void 0, false);\n};\n\n_s(AuthGuard, \"Lv/npDCs8NYAiNXtVN30MhlTHtA=\", false, function () {\n  return [useAuth, useLocation];\n});\n\n_c = AuthGuard;\nexport default AuthGuard;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthGuard\");","map":{"version":3,"names":["useAuth","flat","Navigate","useLocation","AllPages","userHasPermission","pathname","user","routes","matched","find","r","path","authenticated","auth","length","includes","role","alert","AuthGuard","children","isAuthenticated","hasPermission","from"],"sources":["F:/Do An Tot Nghiep/FE/src/app/auth/AuthGuard.jsx"],"sourcesContent":["import useAuth from 'app/hooks/useAuth';\r\nimport { flat } from 'app/utils/utils';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport AllPages from '../routes';\r\n\r\nconst userHasPermission = (pathname, user, routes) => {\r\n  if (!user) {\r\n    return false;\r\n  }\r\n  const matched = routes.find((r) => r.path === pathname);\r\n  const authenticated =\r\n    matched && matched.auth && matched.auth.length ? matched.auth.includes(user.role) : true;\r\n  if (!matched?.auth?.includes(user.role)) {\r\n    alert('Bạn ko có quyền truy cập!');\r\n  }\r\n  return authenticated;\r\n};\r\n\r\nconst AuthGuard = ({ children }) => {\r\n  let { isAuthenticated, user } = useAuth();\r\n  const { pathname } = useLocation();\r\n  const routes = flat(AllPages);\r\n\r\n  const hasPermission = userHasPermission(pathname, user, routes);\r\n  let authenticated = isAuthenticated && hasPermission;\r\n\r\n  // // IF YOU NEED ROLE BASED AUTHENTICATION,\r\n  // // UNCOMMENT ABOVE LINES\r\n  // // AND COMMENT OUT BELOW authenticated VARIABLE\r\n\r\n  // let authenticated = isAuthenticated;\r\n\r\n  return (\r\n    <>\r\n      {authenticated ? (\r\n        children\r\n      ) : (\r\n        <Navigate replace to=\"/session/signin\" state={{ from: pathname }} />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AuthGuard;\r\n"],"mappings":";;;;AAAA,OAAOA,OAAP,MAAoB,mBAApB;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,kBAAtC;AACA,OAAOC,QAAP,MAAqB,WAArB;;;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,QAAD,EAAWC,IAAX,EAAiBC,MAAjB,EAA4B;EAAA;;EACpD,IAAI,CAACD,IAAL,EAAW;IACT,OAAO,KAAP;EACD;;EACD,IAAME,OAAO,GAAGD,MAAM,CAACE,IAAP,CAAY,UAACC,CAAD;IAAA,OAAOA,CAAC,CAACC,IAAF,KAAWN,QAAlB;EAAA,CAAZ,CAAhB;EACA,IAAMO,aAAa,GACjBJ,OAAO,IAAIA,OAAO,CAACK,IAAnB,IAA2BL,OAAO,CAACK,IAAR,CAAaC,MAAxC,GAAiDN,OAAO,CAACK,IAAR,CAAaE,QAAb,CAAsBT,IAAI,CAACU,IAA3B,CAAjD,GAAoF,IADtF;;EAEA,IAAI,EAACR,OAAD,aAACA,OAAD,gCAACA,OAAO,CAAEK,IAAV,0CAAC,cAAeE,QAAf,CAAwBT,IAAI,CAACU,IAA7B,CAAD,CAAJ,EAAyC;IACvCC,KAAK,CAAC,2BAAD,CAAL;EACD;;EACD,OAAOL,aAAP;AACD,CAXD;;AAaA,IAAMM,SAAS,GAAG,SAAZA,SAAY,OAAkB;EAAA;;EAAA,IAAfC,QAAe,QAAfA,QAAe;;EAClC,eAAgCpB,OAAO,EAAvC;EAAA,IAAMqB,eAAN,YAAMA,eAAN;EAAA,IAAuBd,IAAvB,YAAuBA,IAAvB;;EACA,mBAAqBJ,WAAW,EAAhC;EAAA,IAAQG,QAAR,gBAAQA,QAAR;;EACA,IAAME,MAAM,GAAGP,IAAI,CAACG,QAAD,CAAnB;EAEA,IAAMkB,aAAa,GAAGjB,iBAAiB,CAACC,QAAD,EAAWC,IAAX,EAAiBC,MAAjB,CAAvC;EACA,IAAIK,aAAa,GAAGQ,eAAe,IAAIC,aAAvC,CANkC,CAQlC;EACA;EACA;EAEA;;EAEA,oBACE;IAAA,UACGT,aAAa,GACZO,QADY,gBAGZ,QAAC,QAAD;MAAU,OAAO,MAAjB;MAAkB,EAAE,EAAC,iBAArB;MAAuC,KAAK,EAAE;QAAEG,IAAI,EAAEjB;MAAR;IAA9C;MAAA;MAAA;MAAA;IAAA;EAJJ,iBADF;AASD,CAvBD;;GAAMa,S;UAC4BnB,O,EACXG,W;;;KAFjBgB,S;AAyBN,eAAeA,SAAf"},"metadata":{},"sourceType":"module"}